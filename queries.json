{"messages": [{"role": "system", "content": "You are an SQL assistant. You write SQL to query Flipside's Snowflake database with data for the Base blockchain. \n\nThe database has the following tables and columns:\n[{\"TABLE_NAME\":\"dim_contracts\",\"COLUMN_NAMES\":[\"created_block_number\",\"decimals\",\"creator_address\",\"address\",\"created_tx_hash\",\"symbol\",\"name\",\"created_block_timestamp\"]},{\"TABLE_NAME\":\"dim_labels\",\"COLUMN_NAMES\":[\"address_name\",\"label_subtype\",\"label_type\",\"address\",\"blockchain\",\"creator\",\"project_name\"]},{\"TABLE_NAME\":\"ez_decoded_event_logs\",\"COLUMN_NAMES\":[\"origin_to_address\",\"origin_function_signature\",\"event_removed\",\"tx_hash\",\"block_number\",\"full_decoded_log\",\"tx_status\",\"contract_name\",\"data\",\"event_index\",\"event_name\",\"block_timestamp\",\"origin_from_address\",\"contract_address\",\"decoded_log\",\"topics\"]},{\"TABLE_NAME\":\"ez_nft_transfers\",\"COLUMN_NAMES\":[\"event_type\",\"tx_hash\",\"project_name\",\"block_number\",\"nft_from_address\",\"event_index\",\"nft_to_address\",\"nft_address\",\"erc1155_value\",\"tokenid\",\"block_timestamp\"]},{\"TABLE_NAME\":\"fact_blocks\",\"COLUMN_NAMES\":[\"blockchain\",\"size\",\"parent_hash\",\"gas_limit\",\"sha3_uncles\",\"block_header_json\",\"block_number\",\"network\",\"uncle_blocks\",\"extra_data\",\"block_timestamp\",\"difficulty\",\"receipts_root\",\"total_difficulty\",\"hash\",\"gas_used\",\"tx_count\"]},{\"TABLE_NAME\":\"fact_decoded_event_logs\",\"COLUMN_NAMES\":[\"event_index\",\"block_timestamp\",\"decoded_log\",\"tx_hash\",\"event_name\",\"contract_address\",\"full_decoded_log\",\"block_number\"]},{\"TABLE_NAME\":\"fact_event_logs\",\"COLUMN_NAMES\":[\"tx_status\",\"data\",\"tx_hash\",\"_log_id\",\"event_index\",\"block_timestamp\",\"topics\",\"block_number\",\"event_removed\",\"contract_address\",\"origin_from_address\",\"origin_to_address\",\"origin_function_signature\"]},{\"TABLE_NAME\":\"fact_hourly_token_prices\",\"COLUMN_NAMES\":[\"is_imputed\",\"decimals\",\"symbol\",\"token_address\",\"hour\",\"price\"]},{\"TABLE_NAME\":\"fact_token_transfers\",\"COLUMN_NAMES\":[\"to_address\",\"block_timestamp\",\"from_address\",\"raw_amount\",\"raw_amount_precise\",\"origin_function_signature\",\"origin_to_address\",\"contract_address\",\"_log_id\",\"tx_hash\",\"origin_from_address\",\"block_number\"]},{\"TABLE_NAME\":\"fact_traces\",\"COLUMN_NAMES\":[\"type\",\"tx_hash\",\"to_address\",\"trace_index\",\"block_number\",\"gas\",\"from_address\",\"eth_value\",\"eth_value_precise_raw\",\"block_timestamp\",\"data\",\"trace_status\",\"error_reason\",\"eth_value_precise\",\"input\",\"sub_traces\",\"identifier\",\"output\",\"gas_used\",\"tx_status\"]},{\"TABLE_NAME\":\"fact_transactions\",\"COLUMN_NAMES\":[\"cumulative_gas_used\",\"tx_fee_precise\",\"tx_fee\",\"l1_gas_used\",\"position\",\"l1_fee\",\"eth_value\",\"input_data\",\"block_hash\",\"l1_gas_price\",\"l1_fee_precise\",\"v\",\"gas_price\",\"status\",\"effective_gas_price\",\"block_timestamp\",\"l1_submission_details\",\"nonce\",\"eth_value_precise_raw\",\"tx_hash\",\"from_address\",\"max_priority_fee_per_gas\",\"eth_value_precise\",\"gas_limit\",\"block_number\",\"origin_function_signature\",\"l1_fee_scalar\",\"r\",\"gas_used\",\"s\",\"max_fee_per_gas\",\"to_address\"]}]\n\nPlease respond to a user's question about the Base blockchain with a SQL query."}, {"role": "user", "content": "what is the number of daily active users transferring assets to Base?"}, {"role": "assistant", "content": " WITH\n  daus as (\n  SELECT\n  distinct from_address as users,\n  trunc(block_timestamp,'week') as weeks,\n  count(distinct trunc(block_timestamp,'day')) as active_days\n  from base.core.fact_token_transfers\n  group by 1,2\n  having active_days>=4\n  ),\nactive_users as (\n  SELECT\n  trunc(block_timestamp,'week') as date,\n  case when from_address in (select users from daus) then 'DAU'\n  else 'No DAU' end as type,\n  count(distinct from_address) as n_users,\n  count(distinct tx_hash) as txs\n  from base.core.fact_token_transfers\n  group by 1,2\n)\nselect * from active_users \nwhere date>=current_date-interval '{{Months}} MONTHS'\nand date<current_date\norder by 1 asc "}]}
{"messages": [{"role": "system", "content": "You are an SQL assistant. You write SQL to query Flipside's Snowflake database with data for the Base blockchain. \n\nThe database has the following tables and columns:\n[{\"TABLE_NAME\":\"dim_contracts\",\"COLUMN_NAMES\":[\"created_block_number\",\"decimals\",\"creator_address\",\"address\",\"created_tx_hash\",\"symbol\",\"name\",\"created_block_timestamp\"]},{\"TABLE_NAME\":\"dim_labels\",\"COLUMN_NAMES\":[\"address_name\",\"label_subtype\",\"label_type\",\"address\",\"blockchain\",\"creator\",\"project_name\"]},{\"TABLE_NAME\":\"ez_decoded_event_logs\",\"COLUMN_NAMES\":[\"origin_to_address\",\"origin_function_signature\",\"event_removed\",\"tx_hash\",\"block_number\",\"full_decoded_log\",\"tx_status\",\"contract_name\",\"data\",\"event_index\",\"event_name\",\"block_timestamp\",\"origin_from_address\",\"contract_address\",\"decoded_log\",\"topics\"]},{\"TABLE_NAME\":\"ez_nft_transfers\",\"COLUMN_NAMES\":[\"event_type\",\"tx_hash\",\"project_name\",\"block_number\",\"nft_from_address\",\"event_index\",\"nft_to_address\",\"nft_address\",\"erc1155_value\",\"tokenid\",\"block_timestamp\"]},{\"TABLE_NAME\":\"fact_blocks\",\"COLUMN_NAMES\":[\"blockchain\",\"size\",\"parent_hash\",\"gas_limit\",\"sha3_uncles\",\"block_header_json\",\"block_number\",\"network\",\"uncle_blocks\",\"extra_data\",\"block_timestamp\",\"difficulty\",\"receipts_root\",\"total_difficulty\",\"hash\",\"gas_used\",\"tx_count\"]},{\"TABLE_NAME\":\"fact_decoded_event_logs\",\"COLUMN_NAMES\":[\"event_index\",\"block_timestamp\",\"decoded_log\",\"tx_hash\",\"event_name\",\"contract_address\",\"full_decoded_log\",\"block_number\"]},{\"TABLE_NAME\":\"fact_event_logs\",\"COLUMN_NAMES\":[\"tx_status\",\"data\",\"tx_hash\",\"_log_id\",\"event_index\",\"block_timestamp\",\"topics\",\"block_number\",\"event_removed\",\"contract_address\",\"origin_from_address\",\"origin_to_address\",\"origin_function_signature\"]},{\"TABLE_NAME\":\"fact_hourly_token_prices\",\"COLUMN_NAMES\":[\"is_imputed\",\"decimals\",\"symbol\",\"token_address\",\"hour\",\"price\"]},{\"TABLE_NAME\":\"fact_token_transfers\",\"COLUMN_NAMES\":[\"to_address\",\"block_timestamp\",\"from_address\",\"raw_amount\",\"raw_amount_precise\",\"origin_function_signature\",\"origin_to_address\",\"contract_address\",\"_log_id\",\"tx_hash\",\"origin_from_address\",\"block_number\"]},{\"TABLE_NAME\":\"fact_traces\",\"COLUMN_NAMES\":[\"type\",\"tx_hash\",\"to_address\",\"trace_index\",\"block_number\",\"gas\",\"from_address\",\"eth_value\",\"eth_value_precise_raw\",\"block_timestamp\",\"data\",\"trace_status\",\"error_reason\",\"eth_value_precise\",\"input\",\"sub_traces\",\"identifier\",\"output\",\"gas_used\",\"tx_status\"]},{\"TABLE_NAME\":\"fact_transactions\",\"COLUMN_NAMES\":[\"cumulative_gas_used\",\"tx_fee_precise\",\"tx_fee\",\"l1_gas_used\",\"position\",\"l1_fee\",\"eth_value\",\"input_data\",\"block_hash\",\"l1_gas_price\",\"l1_fee_precise\",\"v\",\"gas_price\",\"status\",\"effective_gas_price\",\"block_timestamp\",\"l1_submission_details\",\"nonce\",\"eth_value_precise_raw\",\"tx_hash\",\"from_address\",\"max_priority_fee_per_gas\",\"eth_value_precise\",\"gas_limit\",\"block_number\",\"origin_function_signature\",\"l1_fee_scalar\",\"r\",\"gas_used\",\"s\",\"max_fee_per_gas\",\"to_address\"]}]\n\nPlease respond to a user's question about the Base blockchain with a SQL query."}, {"role": "user", "content": "what is the number of daily active users swapping assets on Base?"}, {"role": "assistant", "content": " WITH\n  daus as (\n  SELECT\n  distinct from_address as users,\n  trunc(block_timestamp,'week') as weeks,\n  count(distinct trunc(block_timestamp,'day')) as active_days\n  from base.core.fact_transactions\nwhere origin_function_signature in ('0xfe029156','0x5c11d795','0x7ff36ab5')\n  group by 1,2\n  having active_days>=4\n  ),\nactive_users as (\n  SELECT\n  trunc(block_timestamp,'week') as date,\n  case when from_address in (select users from daus) then 'DAU'\n  else 'No DAU' end as type,\n  count(distinct from_address) as n_users,\n  count(distinct tx_hash) as txs\n  from base.core.fact_transactions\nwhere origin_function_signature in ('0xfe029156','0x5c11d795','0x7ff36ab5')\n\n  group by 1,2\n)\nselect * from active_users \nwhere date>=current_date-interval '{{Months}} MONTHS'\nand date<current_date\norder by 1 asc "}]}
{"messages": [{"role": "system", "content": "You are an SQL assistant. You write SQL to query Flipside's Snowflake database with data for the Base blockchain. \n\nThe database has the following tables and columns:\n[{\"TABLE_NAME\":\"dim_contracts\",\"COLUMN_NAMES\":[\"created_block_number\",\"decimals\",\"creator_address\",\"address\",\"created_tx_hash\",\"symbol\",\"name\",\"created_block_timestamp\"]},{\"TABLE_NAME\":\"dim_labels\",\"COLUMN_NAMES\":[\"address_name\",\"label_subtype\",\"label_type\",\"address\",\"blockchain\",\"creator\",\"project_name\"]},{\"TABLE_NAME\":\"ez_decoded_event_logs\",\"COLUMN_NAMES\":[\"origin_to_address\",\"origin_function_signature\",\"event_removed\",\"tx_hash\",\"block_number\",\"full_decoded_log\",\"tx_status\",\"contract_name\",\"data\",\"event_index\",\"event_name\",\"block_timestamp\",\"origin_from_address\",\"contract_address\",\"decoded_log\",\"topics\"]},{\"TABLE_NAME\":\"ez_nft_transfers\",\"COLUMN_NAMES\":[\"event_type\",\"tx_hash\",\"project_name\",\"block_number\",\"nft_from_address\",\"event_index\",\"nft_to_address\",\"nft_address\",\"erc1155_value\",\"tokenid\",\"block_timestamp\"]},{\"TABLE_NAME\":\"fact_blocks\",\"COLUMN_NAMES\":[\"blockchain\",\"size\",\"parent_hash\",\"gas_limit\",\"sha3_uncles\",\"block_header_json\",\"block_number\",\"network\",\"uncle_blocks\",\"extra_data\",\"block_timestamp\",\"difficulty\",\"receipts_root\",\"total_difficulty\",\"hash\",\"gas_used\",\"tx_count\"]},{\"TABLE_NAME\":\"fact_decoded_event_logs\",\"COLUMN_NAMES\":[\"event_index\",\"block_timestamp\",\"decoded_log\",\"tx_hash\",\"event_name\",\"contract_address\",\"full_decoded_log\",\"block_number\"]},{\"TABLE_NAME\":\"fact_event_logs\",\"COLUMN_NAMES\":[\"tx_status\",\"data\",\"tx_hash\",\"_log_id\",\"event_index\",\"block_timestamp\",\"topics\",\"block_number\",\"event_removed\",\"contract_address\",\"origin_from_address\",\"origin_to_address\",\"origin_function_signature\"]},{\"TABLE_NAME\":\"fact_hourly_token_prices\",\"COLUMN_NAMES\":[\"is_imputed\",\"decimals\",\"symbol\",\"token_address\",\"hour\",\"price\"]},{\"TABLE_NAME\":\"fact_token_transfers\",\"COLUMN_NAMES\":[\"to_address\",\"block_timestamp\",\"from_address\",\"raw_amount\",\"raw_amount_precise\",\"origin_function_signature\",\"origin_to_address\",\"contract_address\",\"_log_id\",\"tx_hash\",\"origin_from_address\",\"block_number\"]},{\"TABLE_NAME\":\"fact_traces\",\"COLUMN_NAMES\":[\"type\",\"tx_hash\",\"to_address\",\"trace_index\",\"block_number\",\"gas\",\"from_address\",\"eth_value\",\"eth_value_precise_raw\",\"block_timestamp\",\"data\",\"trace_status\",\"error_reason\",\"eth_value_precise\",\"input\",\"sub_traces\",\"identifier\",\"output\",\"gas_used\",\"tx_status\"]},{\"TABLE_NAME\":\"fact_transactions\",\"COLUMN_NAMES\":[\"cumulative_gas_used\",\"tx_fee_precise\",\"tx_fee\",\"l1_gas_used\",\"position\",\"l1_fee\",\"eth_value\",\"input_data\",\"block_hash\",\"l1_gas_price\",\"l1_fee_precise\",\"v\",\"gas_price\",\"status\",\"effective_gas_price\",\"block_timestamp\",\"l1_submission_details\",\"nonce\",\"eth_value_precise_raw\",\"tx_hash\",\"from_address\",\"max_priority_fee_per_gas\",\"eth_value_precise\",\"gas_limit\",\"block_number\",\"origin_function_signature\",\"l1_fee_scalar\",\"r\",\"gas_used\",\"s\",\"max_fee_per_gas\",\"to_address\"]}]\n\nPlease respond to a user's question about the Base blockchain with a SQL query."}, {"role": "user", "content": "what is the number of daily active users using NFTs on Base?"}, {"role": "assistant", "content": "WITH\n  daus as (\n  SELECT\n  distinct nft_from_address as users,\n  trunc(block_timestamp,'week') as weeks,\n  count(distinct trunc(block_timestamp,'day')) as active_days\n  from base.core.ez_nft_transfers\n  group by 1,2\n  having active_days>=4\n  ),\nactive_users as (\n  SELECT\n  trunc(block_timestamp,'week') as date,\n  case when nft_from_address in (select users from daus) then 'DAU'\n  else 'No DAU' end as type,\n  count(distinct nft_from_address) as n_users,\n  count(distinct tx_hash) as txs\n  from base.core.ez_nft_transfers\n  group by 1,2\n)\nselect * from active_users \nwhere date>=current_date-interval '{{Months}} MONTHS'\nand date<current_date\norder by 1 asc "}]}
{"messages": [{"role": "system", "content": "You are an SQL assistant. You write SQL to query Flipside's Snowflake database with data for the Base blockchain. \n\nThe database has the following tables and columns:\n[{\"TABLE_NAME\":\"dim_contracts\",\"COLUMN_NAMES\":[\"created_block_number\",\"decimals\",\"creator_address\",\"address\",\"created_tx_hash\",\"symbol\",\"name\",\"created_block_timestamp\"]},{\"TABLE_NAME\":\"dim_labels\",\"COLUMN_NAMES\":[\"address_name\",\"label_subtype\",\"label_type\",\"address\",\"blockchain\",\"creator\",\"project_name\"]},{\"TABLE_NAME\":\"ez_decoded_event_logs\",\"COLUMN_NAMES\":[\"origin_to_address\",\"origin_function_signature\",\"event_removed\",\"tx_hash\",\"block_number\",\"full_decoded_log\",\"tx_status\",\"contract_name\",\"data\",\"event_index\",\"event_name\",\"block_timestamp\",\"origin_from_address\",\"contract_address\",\"decoded_log\",\"topics\"]},{\"TABLE_NAME\":\"ez_nft_transfers\",\"COLUMN_NAMES\":[\"event_type\",\"tx_hash\",\"project_name\",\"block_number\",\"nft_from_address\",\"event_index\",\"nft_to_address\",\"nft_address\",\"erc1155_value\",\"tokenid\",\"block_timestamp\"]},{\"TABLE_NAME\":\"fact_blocks\",\"COLUMN_NAMES\":[\"blockchain\",\"size\",\"parent_hash\",\"gas_limit\",\"sha3_uncles\",\"block_header_json\",\"block_number\",\"network\",\"uncle_blocks\",\"extra_data\",\"block_timestamp\",\"difficulty\",\"receipts_root\",\"total_difficulty\",\"hash\",\"gas_used\",\"tx_count\"]},{\"TABLE_NAME\":\"fact_decoded_event_logs\",\"COLUMN_NAMES\":[\"event_index\",\"block_timestamp\",\"decoded_log\",\"tx_hash\",\"event_name\",\"contract_address\",\"full_decoded_log\",\"block_number\"]},{\"TABLE_NAME\":\"fact_event_logs\",\"COLUMN_NAMES\":[\"tx_status\",\"data\",\"tx_hash\",\"_log_id\",\"event_index\",\"block_timestamp\",\"topics\",\"block_number\",\"event_removed\",\"contract_address\",\"origin_from_address\",\"origin_to_address\",\"origin_function_signature\"]},{\"TABLE_NAME\":\"fact_hourly_token_prices\",\"COLUMN_NAMES\":[\"is_imputed\",\"decimals\",\"symbol\",\"token_address\",\"hour\",\"price\"]},{\"TABLE_NAME\":\"fact_token_transfers\",\"COLUMN_NAMES\":[\"to_address\",\"block_timestamp\",\"from_address\",\"raw_amount\",\"raw_amount_precise\",\"origin_function_signature\",\"origin_to_address\",\"contract_address\",\"_log_id\",\"tx_hash\",\"origin_from_address\",\"block_number\"]},{\"TABLE_NAME\":\"fact_traces\",\"COLUMN_NAMES\":[\"type\",\"tx_hash\",\"to_address\",\"trace_index\",\"block_number\",\"gas\",\"from_address\",\"eth_value\",\"eth_value_precise_raw\",\"block_timestamp\",\"data\",\"trace_status\",\"error_reason\",\"eth_value_precise\",\"input\",\"sub_traces\",\"identifier\",\"output\",\"gas_used\",\"tx_status\"]},{\"TABLE_NAME\":\"fact_transactions\",\"COLUMN_NAMES\":[\"cumulative_gas_used\",\"tx_fee_precise\",\"tx_fee\",\"l1_gas_used\",\"position\",\"l1_fee\",\"eth_value\",\"input_data\",\"block_hash\",\"l1_gas_price\",\"l1_fee_precise\",\"v\",\"gas_price\",\"status\",\"effective_gas_price\",\"block_timestamp\",\"l1_submission_details\",\"nonce\",\"eth_value_precise_raw\",\"tx_hash\",\"from_address\",\"max_priority_fee_per_gas\",\"eth_value_precise\",\"gas_limit\",\"block_number\",\"origin_function_signature\",\"l1_fee_scalar\",\"r\",\"gas_used\",\"s\",\"max_fee_per_gas\",\"to_address\"]}]\n\nPlease respond to a user's question about the Base blockchain with a SQL query."}, {"role": "user", "content": "what is the number of daily Base transactions by type of user?"}, {"role": "assistant", "content": " WITH\n  daus as (\n  SELECT\n  distinct from_address as users,\n  trunc(block_timestamp,'week') as weeks,\n  count(distinct trunc(block_timestamp,'day')) as active_days\n  from base.core.fact_transactions\n  group by 1,2\n  having active_days>=4\n  ),\nactive_users as (\n  SELECT\n  trunc(block_timestamp,'week') as date,\n  case when from_address in (select users from daus) then 'DAU'\n  else 'No DAU' end as type,\n  count(distinct from_address) as n_users,\n  count(distinct tx_hash) as txs\n  from base.core.fact_transactions\n  group by 1,2\n)\nselect * from active_users \nwhere date>=current_date-interval '{{Months}} MONTHS'\nand date <current_date\norder by 1 asc \n "}]}
{"messages": [{"role": "system", "content": "You are an SQL assistant. You write SQL to query Flipside's Snowflake database with data for the Base blockchain. \n\nThe database has the following tables and columns:\n[{\"TABLE_NAME\":\"dim_contracts\",\"COLUMN_NAMES\":[\"created_block_number\",\"decimals\",\"creator_address\",\"address\",\"created_tx_hash\",\"symbol\",\"name\",\"created_block_timestamp\"]},{\"TABLE_NAME\":\"dim_labels\",\"COLUMN_NAMES\":[\"address_name\",\"label_subtype\",\"label_type\",\"address\",\"blockchain\",\"creator\",\"project_name\"]},{\"TABLE_NAME\":\"ez_decoded_event_logs\",\"COLUMN_NAMES\":[\"origin_to_address\",\"origin_function_signature\",\"event_removed\",\"tx_hash\",\"block_number\",\"full_decoded_log\",\"tx_status\",\"contract_name\",\"data\",\"event_index\",\"event_name\",\"block_timestamp\",\"origin_from_address\",\"contract_address\",\"decoded_log\",\"topics\"]},{\"TABLE_NAME\":\"ez_nft_transfers\",\"COLUMN_NAMES\":[\"event_type\",\"tx_hash\",\"project_name\",\"block_number\",\"nft_from_address\",\"event_index\",\"nft_to_address\",\"nft_address\",\"erc1155_value\",\"tokenid\",\"block_timestamp\"]},{\"TABLE_NAME\":\"fact_blocks\",\"COLUMN_NAMES\":[\"blockchain\",\"size\",\"parent_hash\",\"gas_limit\",\"sha3_uncles\",\"block_header_json\",\"block_number\",\"network\",\"uncle_blocks\",\"extra_data\",\"block_timestamp\",\"difficulty\",\"receipts_root\",\"total_difficulty\",\"hash\",\"gas_used\",\"tx_count\"]},{\"TABLE_NAME\":\"fact_decoded_event_logs\",\"COLUMN_NAMES\":[\"event_index\",\"block_timestamp\",\"decoded_log\",\"tx_hash\",\"event_name\",\"contract_address\",\"full_decoded_log\",\"block_number\"]},{\"TABLE_NAME\":\"fact_event_logs\",\"COLUMN_NAMES\":[\"tx_status\",\"data\",\"tx_hash\",\"_log_id\",\"event_index\",\"block_timestamp\",\"topics\",\"block_number\",\"event_removed\",\"contract_address\",\"origin_from_address\",\"origin_to_address\",\"origin_function_signature\"]},{\"TABLE_NAME\":\"fact_hourly_token_prices\",\"COLUMN_NAMES\":[\"is_imputed\",\"decimals\",\"symbol\",\"token_address\",\"hour\",\"price\"]},{\"TABLE_NAME\":\"fact_token_transfers\",\"COLUMN_NAMES\":[\"to_address\",\"block_timestamp\",\"from_address\",\"raw_amount\",\"raw_amount_precise\",\"origin_function_signature\",\"origin_to_address\",\"contract_address\",\"_log_id\",\"tx_hash\",\"origin_from_address\",\"block_number\"]},{\"TABLE_NAME\":\"fact_traces\",\"COLUMN_NAMES\":[\"type\",\"tx_hash\",\"to_address\",\"trace_index\",\"block_number\",\"gas\",\"from_address\",\"eth_value\",\"eth_value_precise_raw\",\"block_timestamp\",\"data\",\"trace_status\",\"error_reason\",\"eth_value_precise\",\"input\",\"sub_traces\",\"identifier\",\"output\",\"gas_used\",\"tx_status\"]},{\"TABLE_NAME\":\"fact_transactions\",\"COLUMN_NAMES\":[\"cumulative_gas_used\",\"tx_fee_precise\",\"tx_fee\",\"l1_gas_used\",\"position\",\"l1_fee\",\"eth_value\",\"input_data\",\"block_hash\",\"l1_gas_price\",\"l1_fee_precise\",\"v\",\"gas_price\",\"status\",\"effective_gas_price\",\"block_timestamp\",\"l1_submission_details\",\"nonce\",\"eth_value_precise_raw\",\"tx_hash\",\"from_address\",\"max_priority_fee_per_gas\",\"eth_value_precise\",\"gas_limit\",\"block_number\",\"origin_function_signature\",\"l1_fee_scalar\",\"r\",\"gas_used\",\"s\",\"max_fee_per_gas\",\"to_address\"]}]\n\nPlease respond to a user's question about the Base blockchain with a SQL query."}, {"role": "user", "content": "what is the daily and total number of transactions on Base as well as the transactions per section and transaction success rate?"}, {"role": "assistant", "content": "select\n  block_timestamp::date as \"Date\",\n  count(distinct tx_hash) as \"Transactions\",\n  sum(\"Transactions\") over (order by \"Date\") as \"Total Transactions\",\n  \"Transactions\" / 86400 as \"TPS\",\n  sum(case when status = 'SUCCESS' then 1 else 0 end) / \"Transactions\" * 100 as \"Success Rate\",\n  avg(\"TPS\") over (order by \"Date\") as \"Average TPS\",\n  avg(\"Success Rate\") over (order by \"Date\") as \"Average Success Rate\"\nfrom\n  base.core.fact_transactions\nwhere\n  block_timestamp::date < current_date\ngroup by\n  \"Date\"\nqualify\n  \"Date\" >= '2023-07-13'\norder by\n  \"Date\" desc"}]}
{"messages": [{"role": "system", "content": "You are an SQL assistant. You write SQL to query Flipside's Snowflake database with data for the Base blockchain. \n\nThe database has the following tables and columns:\n[{\"TABLE_NAME\":\"dim_contracts\",\"COLUMN_NAMES\":[\"created_block_number\",\"decimals\",\"creator_address\",\"address\",\"created_tx_hash\",\"symbol\",\"name\",\"created_block_timestamp\"]},{\"TABLE_NAME\":\"dim_labels\",\"COLUMN_NAMES\":[\"address_name\",\"label_subtype\",\"label_type\",\"address\",\"blockchain\",\"creator\",\"project_name\"]},{\"TABLE_NAME\":\"ez_decoded_event_logs\",\"COLUMN_NAMES\":[\"origin_to_address\",\"origin_function_signature\",\"event_removed\",\"tx_hash\",\"block_number\",\"full_decoded_log\",\"tx_status\",\"contract_name\",\"data\",\"event_index\",\"event_name\",\"block_timestamp\",\"origin_from_address\",\"contract_address\",\"decoded_log\",\"topics\"]},{\"TABLE_NAME\":\"ez_nft_transfers\",\"COLUMN_NAMES\":[\"event_type\",\"tx_hash\",\"project_name\",\"block_number\",\"nft_from_address\",\"event_index\",\"nft_to_address\",\"nft_address\",\"erc1155_value\",\"tokenid\",\"block_timestamp\"]},{\"TABLE_NAME\":\"fact_blocks\",\"COLUMN_NAMES\":[\"blockchain\",\"size\",\"parent_hash\",\"gas_limit\",\"sha3_uncles\",\"block_header_json\",\"block_number\",\"network\",\"uncle_blocks\",\"extra_data\",\"block_timestamp\",\"difficulty\",\"receipts_root\",\"total_difficulty\",\"hash\",\"gas_used\",\"tx_count\"]},{\"TABLE_NAME\":\"fact_decoded_event_logs\",\"COLUMN_NAMES\":[\"event_index\",\"block_timestamp\",\"decoded_log\",\"tx_hash\",\"event_name\",\"contract_address\",\"full_decoded_log\",\"block_number\"]},{\"TABLE_NAME\":\"fact_event_logs\",\"COLUMN_NAMES\":[\"tx_status\",\"data\",\"tx_hash\",\"_log_id\",\"event_index\",\"block_timestamp\",\"topics\",\"block_number\",\"event_removed\",\"contract_address\",\"origin_from_address\",\"origin_to_address\",\"origin_function_signature\"]},{\"TABLE_NAME\":\"fact_hourly_token_prices\",\"COLUMN_NAMES\":[\"is_imputed\",\"decimals\",\"symbol\",\"token_address\",\"hour\",\"price\"]},{\"TABLE_NAME\":\"fact_token_transfers\",\"COLUMN_NAMES\":[\"to_address\",\"block_timestamp\",\"from_address\",\"raw_amount\",\"raw_amount_precise\",\"origin_function_signature\",\"origin_to_address\",\"contract_address\",\"_log_id\",\"tx_hash\",\"origin_from_address\",\"block_number\"]},{\"TABLE_NAME\":\"fact_traces\",\"COLUMN_NAMES\":[\"type\",\"tx_hash\",\"to_address\",\"trace_index\",\"block_number\",\"gas\",\"from_address\",\"eth_value\",\"eth_value_precise_raw\",\"block_timestamp\",\"data\",\"trace_status\",\"error_reason\",\"eth_value_precise\",\"input\",\"sub_traces\",\"identifier\",\"output\",\"gas_used\",\"tx_status\"]},{\"TABLE_NAME\":\"fact_transactions\",\"COLUMN_NAMES\":[\"cumulative_gas_used\",\"tx_fee_precise\",\"tx_fee\",\"l1_gas_used\",\"position\",\"l1_fee\",\"eth_value\",\"input_data\",\"block_hash\",\"l1_gas_price\",\"l1_fee_precise\",\"v\",\"gas_price\",\"status\",\"effective_gas_price\",\"block_timestamp\",\"l1_submission_details\",\"nonce\",\"eth_value_precise_raw\",\"tx_hash\",\"from_address\",\"max_priority_fee_per_gas\",\"eth_value_precise\",\"gas_limit\",\"block_number\",\"origin_function_signature\",\"l1_fee_scalar\",\"r\",\"gas_used\",\"s\",\"max_fee_per_gas\",\"to_address\"]}]\n\nPlease respond to a user's question about the Base blockchain with a SQL query."}, {"role": "user", "content": "what is the daily numbers of users on base by user type?\n"}, {"role": "assistant", "content": "with\n  active as (\n    select\n      block_timestamp::date as date,\n      count(distinct from_address) as active_users\n    from\n      base.core.fact_transactions\n    where\n      block_timestamp::date < current_date\n    group by\n      date\n  ),\n  new as (\n    select\n      first_timestamp::date as date,\n      count(distinct from_address) as new_users,\n      sum(new_users) over (order by date) as total_users\n    from\n      (\n        select\n          from_address,\n          min(block_timestamp) as first_timestamp\n        from\n          base.core.fact_transactions\n        where\n          block_timestamp::date < current_date\n        group by\n          from_address\n      )\n    group by\n      date\n  )\nselect\n  active.date as \"Date\",\n  active.active_users as \"Active Users\",\n  new.new_users as \"New Users\",\n  new.total_users as \"Total Users\",\n  floor(avg(\"Active Users\") over (order by \"Date\")) as \"MA\",\n  floor(avg(\"Active Users\") over (order by \"Date\" rows between 7 preceding and current row)) as \"MA-7D\",\n  floor(avg(\"Active Users\") over (order by \"Date\" rows between 14 preceding and current row)) as \"MA-14D\",\n  floor(avg(\"Active Users\") over (order by \"Date\" rows between 20 preceding and current row)) as \"MA-21D\",\n  greatest(\"MA\", \"MA-21D\", \"MA-14D\", \"MA-7D\") as \"MA-Max\",\n  least(\"MA\", \"MA-21D\", \"MA-14D\", \"MA-7D\") as \"MA-Min\"\nfrom\n  active\n  left join new on active.date = new.date\nqualify\n  \"Date\" >= '2023-07-13'\norder by\n  \"Date\" desc"}]}
{"messages": [{"role": "system", "content": "You are an SQL assistant. You write SQL to query Flipside's Snowflake database with data for the Base blockchain. \n\nThe database has the following tables and columns:\n[{\"TABLE_NAME\":\"dim_contracts\",\"COLUMN_NAMES\":[\"created_block_number\",\"decimals\",\"creator_address\",\"address\",\"created_tx_hash\",\"symbol\",\"name\",\"created_block_timestamp\"]},{\"TABLE_NAME\":\"dim_labels\",\"COLUMN_NAMES\":[\"address_name\",\"label_subtype\",\"label_type\",\"address\",\"blockchain\",\"creator\",\"project_name\"]},{\"TABLE_NAME\":\"ez_decoded_event_logs\",\"COLUMN_NAMES\":[\"origin_to_address\",\"origin_function_signature\",\"event_removed\",\"tx_hash\",\"block_number\",\"full_decoded_log\",\"tx_status\",\"contract_name\",\"data\",\"event_index\",\"event_name\",\"block_timestamp\",\"origin_from_address\",\"contract_address\",\"decoded_log\",\"topics\"]},{\"TABLE_NAME\":\"ez_nft_transfers\",\"COLUMN_NAMES\":[\"event_type\",\"tx_hash\",\"project_name\",\"block_number\",\"nft_from_address\",\"event_index\",\"nft_to_address\",\"nft_address\",\"erc1155_value\",\"tokenid\",\"block_timestamp\"]},{\"TABLE_NAME\":\"fact_blocks\",\"COLUMN_NAMES\":[\"blockchain\",\"size\",\"parent_hash\",\"gas_limit\",\"sha3_uncles\",\"block_header_json\",\"block_number\",\"network\",\"uncle_blocks\",\"extra_data\",\"block_timestamp\",\"difficulty\",\"receipts_root\",\"total_difficulty\",\"hash\",\"gas_used\",\"tx_count\"]},{\"TABLE_NAME\":\"fact_decoded_event_logs\",\"COLUMN_NAMES\":[\"event_index\",\"block_timestamp\",\"decoded_log\",\"tx_hash\",\"event_name\",\"contract_address\",\"full_decoded_log\",\"block_number\"]},{\"TABLE_NAME\":\"fact_event_logs\",\"COLUMN_NAMES\":[\"tx_status\",\"data\",\"tx_hash\",\"_log_id\",\"event_index\",\"block_timestamp\",\"topics\",\"block_number\",\"event_removed\",\"contract_address\",\"origin_from_address\",\"origin_to_address\",\"origin_function_signature\"]},{\"TABLE_NAME\":\"fact_hourly_token_prices\",\"COLUMN_NAMES\":[\"is_imputed\",\"decimals\",\"symbol\",\"token_address\",\"hour\",\"price\"]},{\"TABLE_NAME\":\"fact_token_transfers\",\"COLUMN_NAMES\":[\"to_address\",\"block_timestamp\",\"from_address\",\"raw_amount\",\"raw_amount_precise\",\"origin_function_signature\",\"origin_to_address\",\"contract_address\",\"_log_id\",\"tx_hash\",\"origin_from_address\",\"block_number\"]},{\"TABLE_NAME\":\"fact_traces\",\"COLUMN_NAMES\":[\"type\",\"tx_hash\",\"to_address\",\"trace_index\",\"block_number\",\"gas\",\"from_address\",\"eth_value\",\"eth_value_precise_raw\",\"block_timestamp\",\"data\",\"trace_status\",\"error_reason\",\"eth_value_precise\",\"input\",\"sub_traces\",\"identifier\",\"output\",\"gas_used\",\"tx_status\"]},{\"TABLE_NAME\":\"fact_transactions\",\"COLUMN_NAMES\":[\"cumulative_gas_used\",\"tx_fee_precise\",\"tx_fee\",\"l1_gas_used\",\"position\",\"l1_fee\",\"eth_value\",\"input_data\",\"block_hash\",\"l1_gas_price\",\"l1_fee_precise\",\"v\",\"gas_price\",\"status\",\"effective_gas_price\",\"block_timestamp\",\"l1_submission_details\",\"nonce\",\"eth_value_precise_raw\",\"tx_hash\",\"from_address\",\"max_priority_fee_per_gas\",\"eth_value_precise\",\"gas_limit\",\"block_number\",\"origin_function_signature\",\"l1_fee_scalar\",\"r\",\"gas_used\",\"s\",\"max_fee_per_gas\",\"to_address\"]}]\n\nPlease respond to a user's question about the Base blockchain with a SQL query."}, {"role": "user", "content": "what is the daily total and median gas fees for transactions on base?\n"}, {"role": "assistant", "content": "select\n  block_timestamp::date as \"Date\",\n  sum(tx_fee) as \"Total Fees\",\n  avg(tx_fee) as \"Average Fee\",\n  median(tx_fee) as \"Median Fee\",\n  sum(gas_used) as \"Total Gas Used\",\n  avg(gas_used) as \"Average Gas Used\",\n  median(gas_used) as \"Median Gas Used\",\n  avg(gas_price) as \"Average Gas Price\",\n  median(gas_price) as \"Median Gas Price\"\nfrom\n  base.core.fact_transactions\nwhere\n  block_timestamp::date < current_date\ngroup by\n  \"Date\"\nqualify\n  \"Date\" >= '2023-07-13'\norder by\n  \"Date\" desc"}]}
{"messages": [{"role": "system", "content": "You are an SQL assistant. You write SQL to query Flipside's Snowflake database with data for the Base blockchain. \n\nThe database has the following tables and columns:\n[{\"TABLE_NAME\":\"dim_contracts\",\"COLUMN_NAMES\":[\"created_block_number\",\"decimals\",\"creator_address\",\"address\",\"created_tx_hash\",\"symbol\",\"name\",\"created_block_timestamp\"]},{\"TABLE_NAME\":\"dim_labels\",\"COLUMN_NAMES\":[\"address_name\",\"label_subtype\",\"label_type\",\"address\",\"blockchain\",\"creator\",\"project_name\"]},{\"TABLE_NAME\":\"ez_decoded_event_logs\",\"COLUMN_NAMES\":[\"origin_to_address\",\"origin_function_signature\",\"event_removed\",\"tx_hash\",\"block_number\",\"full_decoded_log\",\"tx_status\",\"contract_name\",\"data\",\"event_index\",\"event_name\",\"block_timestamp\",\"origin_from_address\",\"contract_address\",\"decoded_log\",\"topics\"]},{\"TABLE_NAME\":\"ez_nft_transfers\",\"COLUMN_NAMES\":[\"event_type\",\"tx_hash\",\"project_name\",\"block_number\",\"nft_from_address\",\"event_index\",\"nft_to_address\",\"nft_address\",\"erc1155_value\",\"tokenid\",\"block_timestamp\"]},{\"TABLE_NAME\":\"fact_blocks\",\"COLUMN_NAMES\":[\"blockchain\",\"size\",\"parent_hash\",\"gas_limit\",\"sha3_uncles\",\"block_header_json\",\"block_number\",\"network\",\"uncle_blocks\",\"extra_data\",\"block_timestamp\",\"difficulty\",\"receipts_root\",\"total_difficulty\",\"hash\",\"gas_used\",\"tx_count\"]},{\"TABLE_NAME\":\"fact_decoded_event_logs\",\"COLUMN_NAMES\":[\"event_index\",\"block_timestamp\",\"decoded_log\",\"tx_hash\",\"event_name\",\"contract_address\",\"full_decoded_log\",\"block_number\"]},{\"TABLE_NAME\":\"fact_event_logs\",\"COLUMN_NAMES\":[\"tx_status\",\"data\",\"tx_hash\",\"_log_id\",\"event_index\",\"block_timestamp\",\"topics\",\"block_number\",\"event_removed\",\"contract_address\",\"origin_from_address\",\"origin_to_address\",\"origin_function_signature\"]},{\"TABLE_NAME\":\"fact_hourly_token_prices\",\"COLUMN_NAMES\":[\"is_imputed\",\"decimals\",\"symbol\",\"token_address\",\"hour\",\"price\"]},{\"TABLE_NAME\":\"fact_token_transfers\",\"COLUMN_NAMES\":[\"to_address\",\"block_timestamp\",\"from_address\",\"raw_amount\",\"raw_amount_precise\",\"origin_function_signature\",\"origin_to_address\",\"contract_address\",\"_log_id\",\"tx_hash\",\"origin_from_address\",\"block_number\"]},{\"TABLE_NAME\":\"fact_traces\",\"COLUMN_NAMES\":[\"type\",\"tx_hash\",\"to_address\",\"trace_index\",\"block_number\",\"gas\",\"from_address\",\"eth_value\",\"eth_value_precise_raw\",\"block_timestamp\",\"data\",\"trace_status\",\"error_reason\",\"eth_value_precise\",\"input\",\"sub_traces\",\"identifier\",\"output\",\"gas_used\",\"tx_status\"]},{\"TABLE_NAME\":\"fact_transactions\",\"COLUMN_NAMES\":[\"cumulative_gas_used\",\"tx_fee_precise\",\"tx_fee\",\"l1_gas_used\",\"position\",\"l1_fee\",\"eth_value\",\"input_data\",\"block_hash\",\"l1_gas_price\",\"l1_fee_precise\",\"v\",\"gas_price\",\"status\",\"effective_gas_price\",\"block_timestamp\",\"l1_submission_details\",\"nonce\",\"eth_value_precise_raw\",\"tx_hash\",\"from_address\",\"max_priority_fee_per_gas\",\"eth_value_precise\",\"gas_limit\",\"block_number\",\"origin_function_signature\",\"l1_fee_scalar\",\"r\",\"gas_used\",\"s\",\"max_fee_per_gas\",\"to_address\"]}]\n\nPlease respond to a user's question about the Base blockchain with a SQL query."}, {"role": "user", "content": "what is the daily number of transactions on Base by protocol?\n"}, {"role": "assistant", "content": "select\n  block_timestamp::date as \"Date\",\n  case origin_to_address\n    when '0x27d2decb4bfc9c76f0309b8e88dec3a601fe25a8' then 'Bald'\n    when '0x3666f603cc164936c1b87e207f36beba4ac5f18a' then 'Base Bridge'\n    when '0x1fc10ef15e041c5d3c54042e52eb0c54cb9b710c' then 'Base Genesis NFT'\n    when '0xc85f505b43fcbffbf7808a55bc4e8cecac18d85b' then 'Based'\n    when '0xc4623408e3060f3c57e1a8d3716123f478e5d82f' then 'CBSwap'\n    when '0xfcd3842f85ed87ba2889b4d35893403796e67ff1' then 'LeetSwap'\n    when '0xf882c982a95f4d3e8187efe12713835406d11840' then 'Merkly ONFT'\n    when '0xb588a34afa5be3f3af703159fb6586a2caf04ba8' then 'OasisSwap'\n    when '0x327df1e6de05895d2ab08513aadd9313fe505d86' then 'PancakeSwap'\n    when '0x89518f11346c761c48cb7086bbd2008806f75149' then 'Pira Passport'\n    when '0xb21d7fdc1b8e3cdbe2061e1f05fd094f46ef2f47' then 'Rainbow Road'\n    when '0x4cf76043b3f97ba06917cbd90f9e3a2aac1b306e' then 'Uniswap'\n    when '0xbceb0ee20ed1489dbea44db08a1e95004ca2753a' then 'Uniswap'\n    when '0xfb7ef66a7e61224dd6fcd0d7d9c3be5c8b049b9f' then 'Uniswap'\n    when '0xaaa3b1f1bd7bcc97fd1917c18ade665c5d31f066' then 'Uniswap'\n    when '0x4200000000000000000000000000000000000006' then 'Wrapped Ether'\n    else 'Unlabeled'\n  end as \"Label\",\n  count(distinct tx_hash) as \"Transactions\",\n  count(distinct origin_from_address) as \"Users\"\nfrom\n  base.core.ez_decoded_event_logs\nwhere\n  tx_status = 'SUCCESS'\n  and block_timestamp::date between '2023-07-13' and (current_date - 1)\ngroup by\n  \"Date\",\n  \"Label\"\norder by\n  \"Date\" desc,\n  \"Transactions\" desc"}]}
{"messages": [{"role": "system", "content": "You are an SQL assistant. You write SQL to query Flipside's Snowflake database with data for the Base blockchain. \n\nThe database has the following tables and columns:\n[{\"TABLE_NAME\":\"dim_contracts\",\"COLUMN_NAMES\":[\"created_block_number\",\"decimals\",\"creator_address\",\"address\",\"created_tx_hash\",\"symbol\",\"name\",\"created_block_timestamp\"]},{\"TABLE_NAME\":\"dim_labels\",\"COLUMN_NAMES\":[\"address_name\",\"label_subtype\",\"label_type\",\"address\",\"blockchain\",\"creator\",\"project_name\"]},{\"TABLE_NAME\":\"ez_decoded_event_logs\",\"COLUMN_NAMES\":[\"origin_to_address\",\"origin_function_signature\",\"event_removed\",\"tx_hash\",\"block_number\",\"full_decoded_log\",\"tx_status\",\"contract_name\",\"data\",\"event_index\",\"event_name\",\"block_timestamp\",\"origin_from_address\",\"contract_address\",\"decoded_log\",\"topics\"]},{\"TABLE_NAME\":\"ez_nft_transfers\",\"COLUMN_NAMES\":[\"event_type\",\"tx_hash\",\"project_name\",\"block_number\",\"nft_from_address\",\"event_index\",\"nft_to_address\",\"nft_address\",\"erc1155_value\",\"tokenid\",\"block_timestamp\"]},{\"TABLE_NAME\":\"fact_blocks\",\"COLUMN_NAMES\":[\"blockchain\",\"size\",\"parent_hash\",\"gas_limit\",\"sha3_uncles\",\"block_header_json\",\"block_number\",\"network\",\"uncle_blocks\",\"extra_data\",\"block_timestamp\",\"difficulty\",\"receipts_root\",\"total_difficulty\",\"hash\",\"gas_used\",\"tx_count\"]},{\"TABLE_NAME\":\"fact_decoded_event_logs\",\"COLUMN_NAMES\":[\"event_index\",\"block_timestamp\",\"decoded_log\",\"tx_hash\",\"event_name\",\"contract_address\",\"full_decoded_log\",\"block_number\"]},{\"TABLE_NAME\":\"fact_event_logs\",\"COLUMN_NAMES\":[\"tx_status\",\"data\",\"tx_hash\",\"_log_id\",\"event_index\",\"block_timestamp\",\"topics\",\"block_number\",\"event_removed\",\"contract_address\",\"origin_from_address\",\"origin_to_address\",\"origin_function_signature\"]},{\"TABLE_NAME\":\"fact_hourly_token_prices\",\"COLUMN_NAMES\":[\"is_imputed\",\"decimals\",\"symbol\",\"token_address\",\"hour\",\"price\"]},{\"TABLE_NAME\":\"fact_token_transfers\",\"COLUMN_NAMES\":[\"to_address\",\"block_timestamp\",\"from_address\",\"raw_amount\",\"raw_amount_precise\",\"origin_function_signature\",\"origin_to_address\",\"contract_address\",\"_log_id\",\"tx_hash\",\"origin_from_address\",\"block_number\"]},{\"TABLE_NAME\":\"fact_traces\",\"COLUMN_NAMES\":[\"type\",\"tx_hash\",\"to_address\",\"trace_index\",\"block_number\",\"gas\",\"from_address\",\"eth_value\",\"eth_value_precise_raw\",\"block_timestamp\",\"data\",\"trace_status\",\"error_reason\",\"eth_value_precise\",\"input\",\"sub_traces\",\"identifier\",\"output\",\"gas_used\",\"tx_status\"]},{\"TABLE_NAME\":\"fact_transactions\",\"COLUMN_NAMES\":[\"cumulative_gas_used\",\"tx_fee_precise\",\"tx_fee\",\"l1_gas_used\",\"position\",\"l1_fee\",\"eth_value\",\"input_data\",\"block_hash\",\"l1_gas_price\",\"l1_fee_precise\",\"v\",\"gas_price\",\"status\",\"effective_gas_price\",\"block_timestamp\",\"l1_submission_details\",\"nonce\",\"eth_value_precise_raw\",\"tx_hash\",\"from_address\",\"max_priority_fee_per_gas\",\"eth_value_precise\",\"gas_limit\",\"block_number\",\"origin_function_signature\",\"l1_fee_scalar\",\"r\",\"gas_used\",\"s\",\"max_fee_per_gas\",\"to_address\"]}]\n\nPlease respond to a user's question about the Base blockchain with a SQL query."}, {"role": "user", "content": "what is the total number of users and transactions on Base by protocol?\n"}, {"role": "assistant", "content": "select\n  origin_to_address as \"Address\",\n  case origin_to_address\n    when '0x27d2decb4bfc9c76f0309b8e88dec3a601fe25a8' then 'Bald'\n    when '0x3666f603cc164936c1b87e207f36beba4ac5f18a' then 'Base Bridge'\n    when '0x1fc10ef15e041c5d3c54042e52eb0c54cb9b710c' then 'Base Genesis NFT'\n    when '0xc85f505b43fcbffbf7808a55bc4e8cecac18d85b' then 'Based'\n    when '0xc4623408e3060f3c57e1a8d3716123f478e5d82f' then 'CBSwap'\n    when '0xfcd3842f85ed87ba2889b4d35893403796e67ff1' then 'LeetSwap'\n    when '0xf882c982a95f4d3e8187efe12713835406d11840' then 'Merkly ONFT'\n    when '0xb588a34afa5be3f3af703159fb6586a2caf04ba8' then 'OasisSwap'\n    when '0x327df1e6de05895d2ab08513aadd9313fe505d86' then 'PancakeSwap'\n    when '0x89518f11346c761c48cb7086bbd2008806f75149' then 'Pira Passport'\n    when '0xb21d7fdc1b8e3cdbe2061e1f05fd094f46ef2f47' then 'Rainbow Road'\n    when '0x4cf76043b3f97ba06917cbd90f9e3a2aac1b306e' then 'Uniswap'\n    when '0xbceb0ee20ed1489dbea44db08a1e95004ca2753a' then 'Uniswap'\n    when '0xfb7ef66a7e61224dd6fcd0d7d9c3be5c8b049b9f' then 'Uniswap'\n    when '0xaaa3b1f1bd7bcc97fd1917c18ade665c5d31f066' then 'Uniswap'\n    when '0x4200000000000000000000000000000000000006' then 'Wrapped Ether'\n    else 'Unlabeled'\n  end as \"Label\",\n  count(distinct tx_hash) as \"Transactions\",\n  count(distinct origin_from_address) as \"Users\"\nfrom\n  base.core.ez_decoded_event_logs\nwhere\n  tx_status = 'SUCCESS'\ngroup by\n  \"Address\",\n  \"Label\"\norder by\n  \"Transactions\" desc\n"}]}
{"messages": [{"role": "system", "content": "You are an SQL assistant. You write SQL to query Flipside's Snowflake database with data for the Base blockchain. \n\nThe database has the following tables and columns:\n[{\"TABLE_NAME\":\"dim_contracts\",\"COLUMN_NAMES\":[\"created_block_number\",\"decimals\",\"creator_address\",\"address\",\"created_tx_hash\",\"symbol\",\"name\",\"created_block_timestamp\"]},{\"TABLE_NAME\":\"dim_labels\",\"COLUMN_NAMES\":[\"address_name\",\"label_subtype\",\"label_type\",\"address\",\"blockchain\",\"creator\",\"project_name\"]},{\"TABLE_NAME\":\"ez_decoded_event_logs\",\"COLUMN_NAMES\":[\"origin_to_address\",\"origin_function_signature\",\"event_removed\",\"tx_hash\",\"block_number\",\"full_decoded_log\",\"tx_status\",\"contract_name\",\"data\",\"event_index\",\"event_name\",\"block_timestamp\",\"origin_from_address\",\"contract_address\",\"decoded_log\",\"topics\"]},{\"TABLE_NAME\":\"ez_nft_transfers\",\"COLUMN_NAMES\":[\"event_type\",\"tx_hash\",\"project_name\",\"block_number\",\"nft_from_address\",\"event_index\",\"nft_to_address\",\"nft_address\",\"erc1155_value\",\"tokenid\",\"block_timestamp\"]},{\"TABLE_NAME\":\"fact_blocks\",\"COLUMN_NAMES\":[\"blockchain\",\"size\",\"parent_hash\",\"gas_limit\",\"sha3_uncles\",\"block_header_json\",\"block_number\",\"network\",\"uncle_blocks\",\"extra_data\",\"block_timestamp\",\"difficulty\",\"receipts_root\",\"total_difficulty\",\"hash\",\"gas_used\",\"tx_count\"]},{\"TABLE_NAME\":\"fact_decoded_event_logs\",\"COLUMN_NAMES\":[\"event_index\",\"block_timestamp\",\"decoded_log\",\"tx_hash\",\"event_name\",\"contract_address\",\"full_decoded_log\",\"block_number\"]},{\"TABLE_NAME\":\"fact_event_logs\",\"COLUMN_NAMES\":[\"tx_status\",\"data\",\"tx_hash\",\"_log_id\",\"event_index\",\"block_timestamp\",\"topics\",\"block_number\",\"event_removed\",\"contract_address\",\"origin_from_address\",\"origin_to_address\",\"origin_function_signature\"]},{\"TABLE_NAME\":\"fact_hourly_token_prices\",\"COLUMN_NAMES\":[\"is_imputed\",\"decimals\",\"symbol\",\"token_address\",\"hour\",\"price\"]},{\"TABLE_NAME\":\"fact_token_transfers\",\"COLUMN_NAMES\":[\"to_address\",\"block_timestamp\",\"from_address\",\"raw_amount\",\"raw_amount_precise\",\"origin_function_signature\",\"origin_to_address\",\"contract_address\",\"_log_id\",\"tx_hash\",\"origin_from_address\",\"block_number\"]},{\"TABLE_NAME\":\"fact_traces\",\"COLUMN_NAMES\":[\"type\",\"tx_hash\",\"to_address\",\"trace_index\",\"block_number\",\"gas\",\"from_address\",\"eth_value\",\"eth_value_precise_raw\",\"block_timestamp\",\"data\",\"trace_status\",\"error_reason\",\"eth_value_precise\",\"input\",\"sub_traces\",\"identifier\",\"output\",\"gas_used\",\"tx_status\"]},{\"TABLE_NAME\":\"fact_transactions\",\"COLUMN_NAMES\":[\"cumulative_gas_used\",\"tx_fee_precise\",\"tx_fee\",\"l1_gas_used\",\"position\",\"l1_fee\",\"eth_value\",\"input_data\",\"block_hash\",\"l1_gas_price\",\"l1_fee_precise\",\"v\",\"gas_price\",\"status\",\"effective_gas_price\",\"block_timestamp\",\"l1_submission_details\",\"nonce\",\"eth_value_precise_raw\",\"tx_hash\",\"from_address\",\"max_priority_fee_per_gas\",\"eth_value_precise\",\"gas_limit\",\"block_number\",\"origin_function_signature\",\"l1_fee_scalar\",\"r\",\"gas_used\",\"s\",\"max_fee_per_gas\",\"to_address\"]}]\n\nPlease respond to a user's question about the Base blockchain with a SQL query."}, {"role": "user", "content": "what are the top nft collections on Base by the number of holders?"}, {"role": "assistant", "content": "SELECT\n  nft_address,\n  project_name,\n  count(DISTINCT address) as holders\n--  sum(holding) as nfts_minted \n\nFROM (\nSELECT\n  address,\n  project_name,\n  nft_address,\n  count(CASE when tx_type LIKE 'in' then 1 end) - count(CASE when tx_type LIKE 'out' then 1 end) as holding\n\nFROM (\nSELECT\n  project_name,\n  nft_address, \n  'out' as tx_type,\n  nft_from_address as address\n  \nFROM base.core.ez_nft_transfers\n\nUNION\n\nSELECT\n  project_name,\n  nft_address, \n  'in' as tx_type,\n  nft_to_address as address\n  \nFROM base.core.ez_nft_transfers\n)\nGROUP BY 1,2,3\n)\nWHERE not holding = 0\nand not address LIKE '0x0000000000000000000000000000000000000000'\nGROUP BY 1,2 \nORDER by 3 DESC\n"}]}
{"messages": [{"role": "system", "content": "You are an SQL assistant. You write SQL to query Flipside's Snowflake database with data for the Base blockchain. \n\nThe database has the following tables and columns:\n[{\"TABLE_NAME\":\"dim_contracts\",\"COLUMN_NAMES\":[\"created_block_number\",\"decimals\",\"creator_address\",\"address\",\"created_tx_hash\",\"symbol\",\"name\",\"created_block_timestamp\"]},{\"TABLE_NAME\":\"dim_labels\",\"COLUMN_NAMES\":[\"address_name\",\"label_subtype\",\"label_type\",\"address\",\"blockchain\",\"creator\",\"project_name\"]},{\"TABLE_NAME\":\"ez_decoded_event_logs\",\"COLUMN_NAMES\":[\"origin_to_address\",\"origin_function_signature\",\"event_removed\",\"tx_hash\",\"block_number\",\"full_decoded_log\",\"tx_status\",\"contract_name\",\"data\",\"event_index\",\"event_name\",\"block_timestamp\",\"origin_from_address\",\"contract_address\",\"decoded_log\",\"topics\"]},{\"TABLE_NAME\":\"ez_nft_transfers\",\"COLUMN_NAMES\":[\"event_type\",\"tx_hash\",\"project_name\",\"block_number\",\"nft_from_address\",\"event_index\",\"nft_to_address\",\"nft_address\",\"erc1155_value\",\"tokenid\",\"block_timestamp\"]},{\"TABLE_NAME\":\"fact_blocks\",\"COLUMN_NAMES\":[\"blockchain\",\"size\",\"parent_hash\",\"gas_limit\",\"sha3_uncles\",\"block_header_json\",\"block_number\",\"network\",\"uncle_blocks\",\"extra_data\",\"block_timestamp\",\"difficulty\",\"receipts_root\",\"total_difficulty\",\"hash\",\"gas_used\",\"tx_count\"]},{\"TABLE_NAME\":\"fact_decoded_event_logs\",\"COLUMN_NAMES\":[\"event_index\",\"block_timestamp\",\"decoded_log\",\"tx_hash\",\"event_name\",\"contract_address\",\"full_decoded_log\",\"block_number\"]},{\"TABLE_NAME\":\"fact_event_logs\",\"COLUMN_NAMES\":[\"tx_status\",\"data\",\"tx_hash\",\"_log_id\",\"event_index\",\"block_timestamp\",\"topics\",\"block_number\",\"event_removed\",\"contract_address\",\"origin_from_address\",\"origin_to_address\",\"origin_function_signature\"]},{\"TABLE_NAME\":\"fact_hourly_token_prices\",\"COLUMN_NAMES\":[\"is_imputed\",\"decimals\",\"symbol\",\"token_address\",\"hour\",\"price\"]},{\"TABLE_NAME\":\"fact_token_transfers\",\"COLUMN_NAMES\":[\"to_address\",\"block_timestamp\",\"from_address\",\"raw_amount\",\"raw_amount_precise\",\"origin_function_signature\",\"origin_to_address\",\"contract_address\",\"_log_id\",\"tx_hash\",\"origin_from_address\",\"block_number\"]},{\"TABLE_NAME\":\"fact_traces\",\"COLUMN_NAMES\":[\"type\",\"tx_hash\",\"to_address\",\"trace_index\",\"block_number\",\"gas\",\"from_address\",\"eth_value\",\"eth_value_precise_raw\",\"block_timestamp\",\"data\",\"trace_status\",\"error_reason\",\"eth_value_precise\",\"input\",\"sub_traces\",\"identifier\",\"output\",\"gas_used\",\"tx_status\"]},{\"TABLE_NAME\":\"fact_transactions\",\"COLUMN_NAMES\":[\"cumulative_gas_used\",\"tx_fee_precise\",\"tx_fee\",\"l1_gas_used\",\"position\",\"l1_fee\",\"eth_value\",\"input_data\",\"block_hash\",\"l1_gas_price\",\"l1_fee_precise\",\"v\",\"gas_price\",\"status\",\"effective_gas_price\",\"block_timestamp\",\"l1_submission_details\",\"nonce\",\"eth_value_precise_raw\",\"tx_hash\",\"from_address\",\"max_priority_fee_per_gas\",\"eth_value_precise\",\"gas_limit\",\"block_number\",\"origin_function_signature\",\"l1_fee_scalar\",\"r\",\"gas_used\",\"s\",\"max_fee_per_gas\",\"to_address\"]}]\n\nPlease respond to a user's question about the Base blockchain with a SQL query."}, {"role": "user", "content": "what is the total number of NFT sales hourly on Base on Coinbase NFT marketplace?\n"}, {"role": "assistant", "content": "with tab1 as (\nSELECT \n  tx_hash as tx,\n  eth_value\n\nFROM base.core.fact_transactions\n), tab2 as (\nSELECT \n  block_timestamp,\n  tx_hash,\n  FULL_DECODED_LOG['data'][6]['value'] as token_address,\n  FULL_DECODED_LOG['data'][1]['value'] as seller,\n  FULL_DECODED_LOG['data'][2]['value'] as buyer\n\nFROM base.core.ez_decoded_event_logs\nWHERE FULL_DECODED_LOG:name LIKE 'ERC721OrderFilled'\nAND contract_address LIKE lower('0xdef1c0ded9bec7f1a1670819833240f027b25eff')\nORDER by block_timestamp\n\n)\n\nSELECT \n  date_trunc('hour', block_timestamp) as hour,\n  sum(ETH_VALUE) nft_sales_volume\nFROM tab2 as a\n  LEFT outer JOIN tab1 as b \n    on a.tx_hash = b.tx\n\nGROUP BY 1 "}]}
{"messages": [{"role": "system", "content": "You are an SQL assistant. You write SQL to query Flipside's Snowflake database with data for the Base blockchain. \n\nThe database has the following tables and columns:\n[{\"TABLE_NAME\":\"dim_contracts\",\"COLUMN_NAMES\":[\"created_block_number\",\"decimals\",\"creator_address\",\"address\",\"created_tx_hash\",\"symbol\",\"name\",\"created_block_timestamp\"]},{\"TABLE_NAME\":\"dim_labels\",\"COLUMN_NAMES\":[\"address_name\",\"label_subtype\",\"label_type\",\"address\",\"blockchain\",\"creator\",\"project_name\"]},{\"TABLE_NAME\":\"ez_decoded_event_logs\",\"COLUMN_NAMES\":[\"origin_to_address\",\"origin_function_signature\",\"event_removed\",\"tx_hash\",\"block_number\",\"full_decoded_log\",\"tx_status\",\"contract_name\",\"data\",\"event_index\",\"event_name\",\"block_timestamp\",\"origin_from_address\",\"contract_address\",\"decoded_log\",\"topics\"]},{\"TABLE_NAME\":\"ez_nft_transfers\",\"COLUMN_NAMES\":[\"event_type\",\"tx_hash\",\"project_name\",\"block_number\",\"nft_from_address\",\"event_index\",\"nft_to_address\",\"nft_address\",\"erc1155_value\",\"tokenid\",\"block_timestamp\"]},{\"TABLE_NAME\":\"fact_blocks\",\"COLUMN_NAMES\":[\"blockchain\",\"size\",\"parent_hash\",\"gas_limit\",\"sha3_uncles\",\"block_header_json\",\"block_number\",\"network\",\"uncle_blocks\",\"extra_data\",\"block_timestamp\",\"difficulty\",\"receipts_root\",\"total_difficulty\",\"hash\",\"gas_used\",\"tx_count\"]},{\"TABLE_NAME\":\"fact_decoded_event_logs\",\"COLUMN_NAMES\":[\"event_index\",\"block_timestamp\",\"decoded_log\",\"tx_hash\",\"event_name\",\"contract_address\",\"full_decoded_log\",\"block_number\"]},{\"TABLE_NAME\":\"fact_event_logs\",\"COLUMN_NAMES\":[\"tx_status\",\"data\",\"tx_hash\",\"_log_id\",\"event_index\",\"block_timestamp\",\"topics\",\"block_number\",\"event_removed\",\"contract_address\",\"origin_from_address\",\"origin_to_address\",\"origin_function_signature\"]},{\"TABLE_NAME\":\"fact_hourly_token_prices\",\"COLUMN_NAMES\":[\"is_imputed\",\"decimals\",\"symbol\",\"token_address\",\"hour\",\"price\"]},{\"TABLE_NAME\":\"fact_token_transfers\",\"COLUMN_NAMES\":[\"to_address\",\"block_timestamp\",\"from_address\",\"raw_amount\",\"raw_amount_precise\",\"origin_function_signature\",\"origin_to_address\",\"contract_address\",\"_log_id\",\"tx_hash\",\"origin_from_address\",\"block_number\"]},{\"TABLE_NAME\":\"fact_traces\",\"COLUMN_NAMES\":[\"type\",\"tx_hash\",\"to_address\",\"trace_index\",\"block_number\",\"gas\",\"from_address\",\"eth_value\",\"eth_value_precise_raw\",\"block_timestamp\",\"data\",\"trace_status\",\"error_reason\",\"eth_value_precise\",\"input\",\"sub_traces\",\"identifier\",\"output\",\"gas_used\",\"tx_status\"]},{\"TABLE_NAME\":\"fact_transactions\",\"COLUMN_NAMES\":[\"cumulative_gas_used\",\"tx_fee_precise\",\"tx_fee\",\"l1_gas_used\",\"position\",\"l1_fee\",\"eth_value\",\"input_data\",\"block_hash\",\"l1_gas_price\",\"l1_fee_precise\",\"v\",\"gas_price\",\"status\",\"effective_gas_price\",\"block_timestamp\",\"l1_submission_details\",\"nonce\",\"eth_value_precise_raw\",\"tx_hash\",\"from_address\",\"max_priority_fee_per_gas\",\"eth_value_precise\",\"gas_limit\",\"block_number\",\"origin_function_signature\",\"l1_fee_scalar\",\"r\",\"gas_used\",\"s\",\"max_fee_per_gas\",\"to_address\"]}]\n\nPlease respond to a user's question about the Base blockchain with a SQL query."}, {"role": "user", "content": "what is the daily and cumulative number of new NFT contracts created on Base?\n"}, {"role": "assistant", "content": "SELECT\n  *,\n  sum(new_nft_contracts) over (ORDER BY min_day) as total_contracts\n\nFROM (\nSELECT\n  min_day,\n  count(*) as new_nft_contracts\n\nFROM (\nSELECT \n  NFT_ADDRESS,\n  min(date_trunc('day', block_timestamp)) as min_day\nFROM base.core.ez_nft_transfers\nWHERE nft_from_address LIKE '0x0000000000000000000000000000000000000000'\nGROUP BY 1\n)\nGROUP BY 1\n)\n"}]}
{"messages": [{"role": "system", "content": "You are an SQL assistant. You write SQL to query Flipside's Snowflake database with data for the Base blockchain. \n\nThe database has the following tables and columns:\n[{\"TABLE_NAME\":\"dim_contracts\",\"COLUMN_NAMES\":[\"created_block_number\",\"decimals\",\"creator_address\",\"address\",\"created_tx_hash\",\"symbol\",\"name\",\"created_block_timestamp\"]},{\"TABLE_NAME\":\"dim_labels\",\"COLUMN_NAMES\":[\"address_name\",\"label_subtype\",\"label_type\",\"address\",\"blockchain\",\"creator\",\"project_name\"]},{\"TABLE_NAME\":\"ez_decoded_event_logs\",\"COLUMN_NAMES\":[\"origin_to_address\",\"origin_function_signature\",\"event_removed\",\"tx_hash\",\"block_number\",\"full_decoded_log\",\"tx_status\",\"contract_name\",\"data\",\"event_index\",\"event_name\",\"block_timestamp\",\"origin_from_address\",\"contract_address\",\"decoded_log\",\"topics\"]},{\"TABLE_NAME\":\"ez_nft_transfers\",\"COLUMN_NAMES\":[\"event_type\",\"tx_hash\",\"project_name\",\"block_number\",\"nft_from_address\",\"event_index\",\"nft_to_address\",\"nft_address\",\"erc1155_value\",\"tokenid\",\"block_timestamp\"]},{\"TABLE_NAME\":\"fact_blocks\",\"COLUMN_NAMES\":[\"blockchain\",\"size\",\"parent_hash\",\"gas_limit\",\"sha3_uncles\",\"block_header_json\",\"block_number\",\"network\",\"uncle_blocks\",\"extra_data\",\"block_timestamp\",\"difficulty\",\"receipts_root\",\"total_difficulty\",\"hash\",\"gas_used\",\"tx_count\"]},{\"TABLE_NAME\":\"fact_decoded_event_logs\",\"COLUMN_NAMES\":[\"event_index\",\"block_timestamp\",\"decoded_log\",\"tx_hash\",\"event_name\",\"contract_address\",\"full_decoded_log\",\"block_number\"]},{\"TABLE_NAME\":\"fact_event_logs\",\"COLUMN_NAMES\":[\"tx_status\",\"data\",\"tx_hash\",\"_log_id\",\"event_index\",\"block_timestamp\",\"topics\",\"block_number\",\"event_removed\",\"contract_address\",\"origin_from_address\",\"origin_to_address\",\"origin_function_signature\"]},{\"TABLE_NAME\":\"fact_hourly_token_prices\",\"COLUMN_NAMES\":[\"is_imputed\",\"decimals\",\"symbol\",\"token_address\",\"hour\",\"price\"]},{\"TABLE_NAME\":\"fact_token_transfers\",\"COLUMN_NAMES\":[\"to_address\",\"block_timestamp\",\"from_address\",\"raw_amount\",\"raw_amount_precise\",\"origin_function_signature\",\"origin_to_address\",\"contract_address\",\"_log_id\",\"tx_hash\",\"origin_from_address\",\"block_number\"]},{\"TABLE_NAME\":\"fact_traces\",\"COLUMN_NAMES\":[\"type\",\"tx_hash\",\"to_address\",\"trace_index\",\"block_number\",\"gas\",\"from_address\",\"eth_value\",\"eth_value_precise_raw\",\"block_timestamp\",\"data\",\"trace_status\",\"error_reason\",\"eth_value_precise\",\"input\",\"sub_traces\",\"identifier\",\"output\",\"gas_used\",\"tx_status\"]},{\"TABLE_NAME\":\"fact_transactions\",\"COLUMN_NAMES\":[\"cumulative_gas_used\",\"tx_fee_precise\",\"tx_fee\",\"l1_gas_used\",\"position\",\"l1_fee\",\"eth_value\",\"input_data\",\"block_hash\",\"l1_gas_price\",\"l1_fee_precise\",\"v\",\"gas_price\",\"status\",\"effective_gas_price\",\"block_timestamp\",\"l1_submission_details\",\"nonce\",\"eth_value_precise_raw\",\"tx_hash\",\"from_address\",\"max_priority_fee_per_gas\",\"eth_value_precise\",\"gas_limit\",\"block_number\",\"origin_function_signature\",\"l1_fee_scalar\",\"r\",\"gas_used\",\"s\",\"max_fee_per_gas\",\"to_address\"]}]\n\nPlease respond to a user's question about the Base blockchain with a SQL query."}, {"role": "user", "content": "what is the total number of Bridge to Base NFT mints and users?\n"}, {"role": "assistant", "content": "SELECT\n  COUNT(TX_HASH) AS \"Number of mints\",\n  COUNT(DISTINCT NFT_TO_ADDRESS) AS \"Number of wallets\"\nFROM\n  base.core.ez_nft_transfers\nWHERE\n  EVENT_TYPE = 'mint'\nAND\n  PROJECT_NAME = 'Bridge to Base'\n\n"}]}
{"messages": [{"role": "system", "content": "You are an SQL assistant. You write SQL to query Flipside's Snowflake database with data for the Base blockchain. \n\nThe database has the following tables and columns:\n[{\"TABLE_NAME\":\"dim_contracts\",\"COLUMN_NAMES\":[\"created_block_number\",\"decimals\",\"creator_address\",\"address\",\"created_tx_hash\",\"symbol\",\"name\",\"created_block_timestamp\"]},{\"TABLE_NAME\":\"dim_labels\",\"COLUMN_NAMES\":[\"address_name\",\"label_subtype\",\"label_type\",\"address\",\"blockchain\",\"creator\",\"project_name\"]},{\"TABLE_NAME\":\"ez_decoded_event_logs\",\"COLUMN_NAMES\":[\"origin_to_address\",\"origin_function_signature\",\"event_removed\",\"tx_hash\",\"block_number\",\"full_decoded_log\",\"tx_status\",\"contract_name\",\"data\",\"event_index\",\"event_name\",\"block_timestamp\",\"origin_from_address\",\"contract_address\",\"decoded_log\",\"topics\"]},{\"TABLE_NAME\":\"ez_nft_transfers\",\"COLUMN_NAMES\":[\"event_type\",\"tx_hash\",\"project_name\",\"block_number\",\"nft_from_address\",\"event_index\",\"nft_to_address\",\"nft_address\",\"erc1155_value\",\"tokenid\",\"block_timestamp\"]},{\"TABLE_NAME\":\"fact_blocks\",\"COLUMN_NAMES\":[\"blockchain\",\"size\",\"parent_hash\",\"gas_limit\",\"sha3_uncles\",\"block_header_json\",\"block_number\",\"network\",\"uncle_blocks\",\"extra_data\",\"block_timestamp\",\"difficulty\",\"receipts_root\",\"total_difficulty\",\"hash\",\"gas_used\",\"tx_count\"]},{\"TABLE_NAME\":\"fact_decoded_event_logs\",\"COLUMN_NAMES\":[\"event_index\",\"block_timestamp\",\"decoded_log\",\"tx_hash\",\"event_name\",\"contract_address\",\"full_decoded_log\",\"block_number\"]},{\"TABLE_NAME\":\"fact_event_logs\",\"COLUMN_NAMES\":[\"tx_status\",\"data\",\"tx_hash\",\"_log_id\",\"event_index\",\"block_timestamp\",\"topics\",\"block_number\",\"event_removed\",\"contract_address\",\"origin_from_address\",\"origin_to_address\",\"origin_function_signature\"]},{\"TABLE_NAME\":\"fact_hourly_token_prices\",\"COLUMN_NAMES\":[\"is_imputed\",\"decimals\",\"symbol\",\"token_address\",\"hour\",\"price\"]},{\"TABLE_NAME\":\"fact_token_transfers\",\"COLUMN_NAMES\":[\"to_address\",\"block_timestamp\",\"from_address\",\"raw_amount\",\"raw_amount_precise\",\"origin_function_signature\",\"origin_to_address\",\"contract_address\",\"_log_id\",\"tx_hash\",\"origin_from_address\",\"block_number\"]},{\"TABLE_NAME\":\"fact_traces\",\"COLUMN_NAMES\":[\"type\",\"tx_hash\",\"to_address\",\"trace_index\",\"block_number\",\"gas\",\"from_address\",\"eth_value\",\"eth_value_precise_raw\",\"block_timestamp\",\"data\",\"trace_status\",\"error_reason\",\"eth_value_precise\",\"input\",\"sub_traces\",\"identifier\",\"output\",\"gas_used\",\"tx_status\"]},{\"TABLE_NAME\":\"fact_transactions\",\"COLUMN_NAMES\":[\"cumulative_gas_used\",\"tx_fee_precise\",\"tx_fee\",\"l1_gas_used\",\"position\",\"l1_fee\",\"eth_value\",\"input_data\",\"block_hash\",\"l1_gas_price\",\"l1_fee_precise\",\"v\",\"gas_price\",\"status\",\"effective_gas_price\",\"block_timestamp\",\"l1_submission_details\",\"nonce\",\"eth_value_precise_raw\",\"tx_hash\",\"from_address\",\"max_priority_fee_per_gas\",\"eth_value_precise\",\"gas_limit\",\"block_number\",\"origin_function_signature\",\"l1_fee_scalar\",\"r\",\"gas_used\",\"s\",\"max_fee_per_gas\",\"to_address\"]}]\n\nPlease respond to a user's question about the Base blockchain with a SQL query."}, {"role": "user", "content": "what are the top NFT collections by number of mints on Base?\n"}, {"role": "assistant", "content": "SELECT\n  --BLOCK_TIMESTAMP as date,\n  PROJECT_NAME AS \"NFT Collection\",\n  COUNT(TX_HASH) AS \"NFTs minted\"\nFROM\n  base.core.ez_nft_transfers\nWHERE\n  EVENT_TYPE = 'mint'\nAND \n  PROJECT_NAME != ''\nGROUP BY 1\nORDER BY 2 DESC"}]}
{"messages": [{"role": "system", "content": "You are an SQL assistant. You write SQL to query Flipside's Snowflake database with data for the Base blockchain. \n\nThe database has the following tables and columns:\n[{\"TABLE_NAME\":\"dim_contracts\",\"COLUMN_NAMES\":[\"created_block_number\",\"decimals\",\"creator_address\",\"address\",\"created_tx_hash\",\"symbol\",\"name\",\"created_block_timestamp\"]},{\"TABLE_NAME\":\"dim_labels\",\"COLUMN_NAMES\":[\"address_name\",\"label_subtype\",\"label_type\",\"address\",\"blockchain\",\"creator\",\"project_name\"]},{\"TABLE_NAME\":\"ez_decoded_event_logs\",\"COLUMN_NAMES\":[\"origin_to_address\",\"origin_function_signature\",\"event_removed\",\"tx_hash\",\"block_number\",\"full_decoded_log\",\"tx_status\",\"contract_name\",\"data\",\"event_index\",\"event_name\",\"block_timestamp\",\"origin_from_address\",\"contract_address\",\"decoded_log\",\"topics\"]},{\"TABLE_NAME\":\"ez_nft_transfers\",\"COLUMN_NAMES\":[\"event_type\",\"tx_hash\",\"project_name\",\"block_number\",\"nft_from_address\",\"event_index\",\"nft_to_address\",\"nft_address\",\"erc1155_value\",\"tokenid\",\"block_timestamp\"]},{\"TABLE_NAME\":\"fact_blocks\",\"COLUMN_NAMES\":[\"blockchain\",\"size\",\"parent_hash\",\"gas_limit\",\"sha3_uncles\",\"block_header_json\",\"block_number\",\"network\",\"uncle_blocks\",\"extra_data\",\"block_timestamp\",\"difficulty\",\"receipts_root\",\"total_difficulty\",\"hash\",\"gas_used\",\"tx_count\"]},{\"TABLE_NAME\":\"fact_decoded_event_logs\",\"COLUMN_NAMES\":[\"event_index\",\"block_timestamp\",\"decoded_log\",\"tx_hash\",\"event_name\",\"contract_address\",\"full_decoded_log\",\"block_number\"]},{\"TABLE_NAME\":\"fact_event_logs\",\"COLUMN_NAMES\":[\"tx_status\",\"data\",\"tx_hash\",\"_log_id\",\"event_index\",\"block_timestamp\",\"topics\",\"block_number\",\"event_removed\",\"contract_address\",\"origin_from_address\",\"origin_to_address\",\"origin_function_signature\"]},{\"TABLE_NAME\":\"fact_hourly_token_prices\",\"COLUMN_NAMES\":[\"is_imputed\",\"decimals\",\"symbol\",\"token_address\",\"hour\",\"price\"]},{\"TABLE_NAME\":\"fact_token_transfers\",\"COLUMN_NAMES\":[\"to_address\",\"block_timestamp\",\"from_address\",\"raw_amount\",\"raw_amount_precise\",\"origin_function_signature\",\"origin_to_address\",\"contract_address\",\"_log_id\",\"tx_hash\",\"origin_from_address\",\"block_number\"]},{\"TABLE_NAME\":\"fact_traces\",\"COLUMN_NAMES\":[\"type\",\"tx_hash\",\"to_address\",\"trace_index\",\"block_number\",\"gas\",\"from_address\",\"eth_value\",\"eth_value_precise_raw\",\"block_timestamp\",\"data\",\"trace_status\",\"error_reason\",\"eth_value_precise\",\"input\",\"sub_traces\",\"identifier\",\"output\",\"gas_used\",\"tx_status\"]},{\"TABLE_NAME\":\"fact_transactions\",\"COLUMN_NAMES\":[\"cumulative_gas_used\",\"tx_fee_precise\",\"tx_fee\",\"l1_gas_used\",\"position\",\"l1_fee\",\"eth_value\",\"input_data\",\"block_hash\",\"l1_gas_price\",\"l1_fee_precise\",\"v\",\"gas_price\",\"status\",\"effective_gas_price\",\"block_timestamp\",\"l1_submission_details\",\"nonce\",\"eth_value_precise_raw\",\"tx_hash\",\"from_address\",\"max_priority_fee_per_gas\",\"eth_value_precise\",\"gas_limit\",\"block_number\",\"origin_function_signature\",\"l1_fee_scalar\",\"r\",\"gas_used\",\"s\",\"max_fee_per_gas\",\"to_address\"]}]\n\nPlease respond to a user's question about the Base blockchain with a SQL query."}, {"role": "user", "content": "what is the cumulative transfer volume on Base over time?"}, {"role": "assistant", "content": "with contracts as (\nselect  ADDRESS ,SYMBOL \nfrom base.core.dim_contracts\ngroup by 1 ,2 \n),\nprices as (\nselect HOUR::date date ,   SYMBOL , \nTOKEN_ADDRESS , DECIMALS,\navg(price) price \nfrom base.core.fact_hourly_token_prices\ngroup  by 1 , 2 ,3 ,4 order by 1 \n)\nselect  \nblock_timestamp::date date , \nsum ((RAW_AMOUNT/pow(10,DECIMALS))*price) volume_usd,\nsum (volume_usd) over (order by block_timestamp::date ) cum_volume_USD\nfrom base.core.fact_token_transfers  t join prices p on TOKEN_ADDRESS = CONTRACT_ADDRESS\nand p.date =t.BLOCK_TIMESTAMP::date  \ngroup by 1 \n"}]}
{"messages": [{"role": "system", "content": "You are an SQL assistant. You write SQL to query Flipside's Snowflake database with data for the Base blockchain. \n\nThe database has the following tables and columns:\n[{\"TABLE_NAME\":\"dim_contracts\",\"COLUMN_NAMES\":[\"created_block_number\",\"decimals\",\"creator_address\",\"address\",\"created_tx_hash\",\"symbol\",\"name\",\"created_block_timestamp\"]},{\"TABLE_NAME\":\"dim_labels\",\"COLUMN_NAMES\":[\"address_name\",\"label_subtype\",\"label_type\",\"address\",\"blockchain\",\"creator\",\"project_name\"]},{\"TABLE_NAME\":\"ez_decoded_event_logs\",\"COLUMN_NAMES\":[\"origin_to_address\",\"origin_function_signature\",\"event_removed\",\"tx_hash\",\"block_number\",\"full_decoded_log\",\"tx_status\",\"contract_name\",\"data\",\"event_index\",\"event_name\",\"block_timestamp\",\"origin_from_address\",\"contract_address\",\"decoded_log\",\"topics\"]},{\"TABLE_NAME\":\"ez_nft_transfers\",\"COLUMN_NAMES\":[\"event_type\",\"tx_hash\",\"project_name\",\"block_number\",\"nft_from_address\",\"event_index\",\"nft_to_address\",\"nft_address\",\"erc1155_value\",\"tokenid\",\"block_timestamp\"]},{\"TABLE_NAME\":\"fact_blocks\",\"COLUMN_NAMES\":[\"blockchain\",\"size\",\"parent_hash\",\"gas_limit\",\"sha3_uncles\",\"block_header_json\",\"block_number\",\"network\",\"uncle_blocks\",\"extra_data\",\"block_timestamp\",\"difficulty\",\"receipts_root\",\"total_difficulty\",\"hash\",\"gas_used\",\"tx_count\"]},{\"TABLE_NAME\":\"fact_decoded_event_logs\",\"COLUMN_NAMES\":[\"event_index\",\"block_timestamp\",\"decoded_log\",\"tx_hash\",\"event_name\",\"contract_address\",\"full_decoded_log\",\"block_number\"]},{\"TABLE_NAME\":\"fact_event_logs\",\"COLUMN_NAMES\":[\"tx_status\",\"data\",\"tx_hash\",\"_log_id\",\"event_index\",\"block_timestamp\",\"topics\",\"block_number\",\"event_removed\",\"contract_address\",\"origin_from_address\",\"origin_to_address\",\"origin_function_signature\"]},{\"TABLE_NAME\":\"fact_hourly_token_prices\",\"COLUMN_NAMES\":[\"is_imputed\",\"decimals\",\"symbol\",\"token_address\",\"hour\",\"price\"]},{\"TABLE_NAME\":\"fact_token_transfers\",\"COLUMN_NAMES\":[\"to_address\",\"block_timestamp\",\"from_address\",\"raw_amount\",\"raw_amount_precise\",\"origin_function_signature\",\"origin_to_address\",\"contract_address\",\"_log_id\",\"tx_hash\",\"origin_from_address\",\"block_number\"]},{\"TABLE_NAME\":\"fact_traces\",\"COLUMN_NAMES\":[\"type\",\"tx_hash\",\"to_address\",\"trace_index\",\"block_number\",\"gas\",\"from_address\",\"eth_value\",\"eth_value_precise_raw\",\"block_timestamp\",\"data\",\"trace_status\",\"error_reason\",\"eth_value_precise\",\"input\",\"sub_traces\",\"identifier\",\"output\",\"gas_used\",\"tx_status\"]},{\"TABLE_NAME\":\"fact_transactions\",\"COLUMN_NAMES\":[\"cumulative_gas_used\",\"tx_fee_precise\",\"tx_fee\",\"l1_gas_used\",\"position\",\"l1_fee\",\"eth_value\",\"input_data\",\"block_hash\",\"l1_gas_price\",\"l1_fee_precise\",\"v\",\"gas_price\",\"status\",\"effective_gas_price\",\"block_timestamp\",\"l1_submission_details\",\"nonce\",\"eth_value_precise_raw\",\"tx_hash\",\"from_address\",\"max_priority_fee_per_gas\",\"eth_value_precise\",\"gas_limit\",\"block_number\",\"origin_function_signature\",\"l1_fee_scalar\",\"r\",\"gas_used\",\"s\",\"max_fee_per_gas\",\"to_address\"]}]\n\nPlease respond to a user's question about the Base blockchain with a SQL query."}, {"role": "user", "content": "what is the cumulative transfer volume on Base over time by token?\n"}, {"role": "assistant", "content": " with contracts as (\nselect  ADDRESS ,SYMBOL \nfrom base.core.dim_contracts\ngroup by 1 ,2 \n),\nprices as (\nselect HOUR::date date ,   SYMBOL , \nTOKEN_ADDRESS , DECIMALS,\navg(price) price \nfrom base.core.fact_hourly_token_prices\ngroup  by 1 , 2 ,3 ,4 order by 1 \n)\nselect  \nblock_timestamp::date date ,\n SYMBOL , \nsum ((RAW_AMOUNT/pow(10,DECIMALS))*price) volume_usd,\nsum (volume_usd) over ( order by block_timestamp::date , symbol ) cum_volume_USD\nfrom base.core.fact_token_transfers  t join prices p on TOKEN_ADDRESS = CONTRACT_ADDRESS\nand p.date =t.BLOCK_TIMESTAMP::date  \ngroup by 1 ,2  order by date \n"}]}
{"messages": [{"role": "system", "content": "You are an SQL assistant. You write SQL to query Flipside's Snowflake database with data for the Base blockchain. \n\nThe database has the following tables and columns:\n[{\"TABLE_NAME\":\"dim_contracts\",\"COLUMN_NAMES\":[\"created_block_number\",\"decimals\",\"creator_address\",\"address\",\"created_tx_hash\",\"symbol\",\"name\",\"created_block_timestamp\"]},{\"TABLE_NAME\":\"dim_labels\",\"COLUMN_NAMES\":[\"address_name\",\"label_subtype\",\"label_type\",\"address\",\"blockchain\",\"creator\",\"project_name\"]},{\"TABLE_NAME\":\"ez_decoded_event_logs\",\"COLUMN_NAMES\":[\"origin_to_address\",\"origin_function_signature\",\"event_removed\",\"tx_hash\",\"block_number\",\"full_decoded_log\",\"tx_status\",\"contract_name\",\"data\",\"event_index\",\"event_name\",\"block_timestamp\",\"origin_from_address\",\"contract_address\",\"decoded_log\",\"topics\"]},{\"TABLE_NAME\":\"ez_nft_transfers\",\"COLUMN_NAMES\":[\"event_type\",\"tx_hash\",\"project_name\",\"block_number\",\"nft_from_address\",\"event_index\",\"nft_to_address\",\"nft_address\",\"erc1155_value\",\"tokenid\",\"block_timestamp\"]},{\"TABLE_NAME\":\"fact_blocks\",\"COLUMN_NAMES\":[\"blockchain\",\"size\",\"parent_hash\",\"gas_limit\",\"sha3_uncles\",\"block_header_json\",\"block_number\",\"network\",\"uncle_blocks\",\"extra_data\",\"block_timestamp\",\"difficulty\",\"receipts_root\",\"total_difficulty\",\"hash\",\"gas_used\",\"tx_count\"]},{\"TABLE_NAME\":\"fact_decoded_event_logs\",\"COLUMN_NAMES\":[\"event_index\",\"block_timestamp\",\"decoded_log\",\"tx_hash\",\"event_name\",\"contract_address\",\"full_decoded_log\",\"block_number\"]},{\"TABLE_NAME\":\"fact_event_logs\",\"COLUMN_NAMES\":[\"tx_status\",\"data\",\"tx_hash\",\"_log_id\",\"event_index\",\"block_timestamp\",\"topics\",\"block_number\",\"event_removed\",\"contract_address\",\"origin_from_address\",\"origin_to_address\",\"origin_function_signature\"]},{\"TABLE_NAME\":\"fact_hourly_token_prices\",\"COLUMN_NAMES\":[\"is_imputed\",\"decimals\",\"symbol\",\"token_address\",\"hour\",\"price\"]},{\"TABLE_NAME\":\"fact_token_transfers\",\"COLUMN_NAMES\":[\"to_address\",\"block_timestamp\",\"from_address\",\"raw_amount\",\"raw_amount_precise\",\"origin_function_signature\",\"origin_to_address\",\"contract_address\",\"_log_id\",\"tx_hash\",\"origin_from_address\",\"block_number\"]},{\"TABLE_NAME\":\"fact_traces\",\"COLUMN_NAMES\":[\"type\",\"tx_hash\",\"to_address\",\"trace_index\",\"block_number\",\"gas\",\"from_address\",\"eth_value\",\"eth_value_precise_raw\",\"block_timestamp\",\"data\",\"trace_status\",\"error_reason\",\"eth_value_precise\",\"input\",\"sub_traces\",\"identifier\",\"output\",\"gas_used\",\"tx_status\"]},{\"TABLE_NAME\":\"fact_transactions\",\"COLUMN_NAMES\":[\"cumulative_gas_used\",\"tx_fee_precise\",\"tx_fee\",\"l1_gas_used\",\"position\",\"l1_fee\",\"eth_value\",\"input_data\",\"block_hash\",\"l1_gas_price\",\"l1_fee_precise\",\"v\",\"gas_price\",\"status\",\"effective_gas_price\",\"block_timestamp\",\"l1_submission_details\",\"nonce\",\"eth_value_precise_raw\",\"tx_hash\",\"from_address\",\"max_priority_fee_per_gas\",\"eth_value_precise\",\"gas_limit\",\"block_number\",\"origin_function_signature\",\"l1_fee_scalar\",\"r\",\"gas_used\",\"s\",\"max_fee_per_gas\",\"to_address\"]}]\n\nPlease respond to a user's question about the Base blockchain with a SQL query."}, {"role": "user", "content": "what is the distrobution of Base transfers by transfer size?\n"}, {"role": "assistant", "content": "with contracts as (\nselect  ADDRESS ,SYMBOL \nfrom base.core.dim_contracts\ngroup by 1 ,2 \n),\nprices as (\nselect HOUR::date date ,   SYMBOL , \nTOKEN_ADDRESS , DECIMALS,\navg(price) price \nfrom base.core.fact_hourly_token_prices\ngroup  by 1 , 2 ,3 ,4 order by 1 \n),\nwallet as (select  \nFROM_ADDRESS ,\nsum ((RAW_AMOUNT/pow(10,DECIMALS))*price) volume_usd\nfrom base.core.fact_token_transfers t join prices p on TOKEN_ADDRESS = CONTRACT_ADDRESS\nand p.date =t.BLOCK_TIMESTAMP::date  \ngroup by 1\n) \nselect case when volume_usd <1 then 'Less Than $1'\nwhen volume_usd BETWEEN 1 and 5 then '$1 - $5'\nwhen volume_usd BETWEEN 5 and 10 then '$5 - $10'\nwhen volume_usd BETWEEN 10 and 20 then '$10 - $20'\nwhen volume_usd BETWEEN 20 and 100 then '$20 - $100'\nwhen volume_usd BETWEEN 100 and 500 then '$100 - $500'\nwhen volume_usd BETWEEN 500 and 1000 then '$500 - $1K'\nwhen volume_usd BETWEEN 1000 and 10000 then '$1K - $10K'\nelse 'More than $10K'\nend range ,\ncount (FROM_ADDRESS) num_wallets \nfrom wallet \ngroup by 1 "}]}
